Ly8gQXV0aG9yIDogRGF2aXN0YXIgLy8KI2luY2x1ZGUgPHN0ZGlvLmg+CiNpbmNsdWRlIDxzdGRs
aWIuaD4KI2luY2x1ZGUgPHdpbnNvY2syLmg+CiNpbmNsdWRlIDx3czJ0Y3BpcC5oPgojaW5jbHVk
ZSA8d2luZG93cy5oPgojcHJhZ21hIGNvbW1lbnQobGliLCAiV3MyXzMyLmxpYiIpCiNkZWZpbmUg
REVGQVVMVF9CVUZMRU4gNDA5NgojZGVmaW5lIFBPUlQgWU9VUlBPUlQKCmludCBtYWluKCl7CiAg
ICBGcmVlQ29uc29sZSgpOwogICAgd2hpbGUgKHRydWUpewogICAgICAgIFNsZWVwKDUwMDApOwog
ICAgICAgIAogICAgICAgIGNoYXIgTEhPU1RbXSA9ICJZT1VSTEhPU1QiOwogICAgICAgIAogICAg
ICAgIFNPQ0tFVCBzb2NrczsKICAgICAgICBzb2NrYWRkcl9pbiBhZGRyOwogICAgICAgIFdTQURB
VEEgdmVyc2lvbjsKICAgICAgICBXU0FTdGFydHVwKE1BS0VXT1JEKDIsMiksICZ2ZXJzaW9uKTsK
ICAgICAgICBzb2NrcyA9IFdTQVNvY2tldChBRl9JTkVULFNPQ0tfU1RSRUFNLElQUFJPVE9fVENQ
LCBOVUxMLCAodW5zaWduZWQgaW50KU5VTEwsICh1bnNpZ25lZCBpbnQpTlVMTCk7CiAgICAgICAg
YWRkci5zaW5fZmFtaWx5ID0gQUZfSU5FVDsKICAgICAgICBhZGRyLnNpbl9hZGRyLnNfYWRkciA9
IGluZXRfYWRkcihMSE9TVCk7CiAgICAgICAgYWRkci5zaW5fcG9ydCA9IGh0b25zKFBPUlQpOwog
ICAgICAgIGlmIChXU0FDb25uZWN0KHNvY2tzLCAoU09DS0FERFIqKSZhZGRyLCBzaXplb2YoYWRk
ciksIE5VTEwsIE5VTEwsIE5VTEwsIE5VTEwpPT1TT0NLRVRfRVJST1IpIHsKICAgICAgICAgICAg
Y2xvc2Vzb2NrZXQoc29ja3MpOwogICAgICAgICAgICBXU0FDbGVhbnVwKCk7CiAgICAgICAgICAg
IGNvbnRpbnVlOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgY2hhciBSZWN2
RGF0YVtERUZBVUxUX0JVRkxFTl07CiAgICAgICAgICAgIG1lbXNldChSZWN2RGF0YSwgMCwgc2l6
ZW9mKFJlY3ZEYXRhKSk7CiAgICAgICAgICAgIGludCBSZWN2Q29kZSA9IHJlY3Yoc29ja3MsIFJl
Y3ZEYXRhLCBERUZBVUxUX0JVRkxFTiwgMCk7CiAgICAgICAgICAgIGlmIChSZWN2Q29kZSA8PSAw
KSB7CiAgICAgICAgICAgICAgICBjbG9zZXNvY2tldChzb2Nrcyk7CiAgICAgICAgICAgICAgICBX
U0FDbGVhbnVwKCk7CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQogICAg
ICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIGNoYXIgUHJvY2Vzc1tdID0gImNtZC5leGUi
OwogICAgICAgICAgICAgICAgU1RBUlRVUElORk8gc2luZm87CiAgICAgICAgICAgICAgICBQUk9D
RVNTX0lORk9STUFUSU9OIHBpbmZvOwogICAgICAgICAgICAgICAgbWVtc2V0KCZzaW5mbywgMCwg
c2l6ZW9mKHNpbmZvKSk7CiAgICAgICAgICAgICAgICBzaW5mby5jYiA9IHNpemVvZihzaW5mbyk7
CiAgICAgICAgICAgICAgICBzaW5mby5kd0ZsYWdzID0gKFNUQVJURl9VU0VTVERIQU5ETEVTIHwg
U1RBUlRGX1VTRVNIT1dXSU5ET1cpOwogICAgICAgICAgICAgICAgc2luZm8uaFN0ZElucHV0ID0g
c2luZm8uaFN0ZE91dHB1dCA9IHNpbmZvLmhTdGRFcnJvciA9IChIQU5ETEUpIHNvY2tzOwogICAg
ICAgICAgICAgICAgQ3JlYXRlUHJvY2VzcyhOVUxMLCBQcm9jZXNzLCBOVUxMLCBOVUxMLCBUUlVF
LCAwLCBOVUxMLCBOVUxMLCAmc2luZm8sICZwaW5mbyk7CiAgICAgICAgICAgICAgICBXYWl0Rm9y
U2luZ2xlT2JqZWN0KHBpbmZvLmhQcm9jZXNzLCBJTkZJTklURSk7CiAgICAgICAgICAgICAgICBD
bG9zZUhhbmRsZShwaW5mby5oUHJvY2Vzcyk7CiAgICAgICAgICAgICAgICBDbG9zZUhhbmRsZShw
aW5mby5oVGhyZWFkKTsKCiAgICAgICAgICAgICAgICBtZW1zZXQoUmVjdkRhdGEsIDAsIHNpemVv
ZihSZWN2RGF0YSkpOwogICAgICAgICAgICAgICAgaW50IFJlY3ZDb2RlID0gcmVjdihzb2Nrcywg
UmVjdkRhdGEsIERFRkFVTFRfQlVGTEVOLCAwKTsKICAgICAgICAgICAgICAgIGlmIChSZWN2Q29k
ZSA8PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgY2xvc2Vzb2NrZXQoc29ja3MpOwogICAgICAg
ICAgICAgICAgICAgIFdTQUNsZWFudXAoKTsKICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsK
ICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChzdHJjbXAoUmVjdkRhdGEsICJl
eGl0XG4iKSA9PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgZXhpdCgwKTsKICAgICAgICAgICAg
ICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQo=
